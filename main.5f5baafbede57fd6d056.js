(()=>{"use strict";function e(t){return e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},e(t)}function t(e){return function(e){if(Array.isArray(e))return a(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(e){if("string"==typeof e)return a(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?a(e,t):void 0}}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function a(e,t){(null==t||t>e.length)&&(t=e.length);for(var a=0,r=new Array(t);a<t;a++)r[a]=e[a];return r}function r(t,a){for(var r=0;r<a.length;r++){var s=a[r];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(t,(void 0,i=function(t,a){if("object"!==e(t)||null===t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var s=r.call(t,"string");if("object"!==e(s))return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(s.key),"symbol"===e(i)?i:String(i)),s)}var i}var s=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.capsFlag=!1,this.shiftFlag=!1,this.shiftType=null,this.positionCursor=0,this.languageFlag=!1,this.currentLanguage=null,this.keyboardCodes=["Backquote","Digit1","Digit2","Digit3","Digit4","Digit5","Digit6","Digit7","Digit8","Digit9","Digit0","Minus","Equal","Backspace","Tab","KeyQ","KeyW","KeyE","KeyR","KeyT","KeyY","KeyU","KeyI","KeyO","KeyP","BracketLeft","BracketRight","Backslash","Delete","CapsLock","KeyA","KeyS","KeyD","KeyF","KeyG","KeyH","KeyJ","KeyK","KeyL","Semicolon","Quote","Enter","ShiftLeft","KeyZ","KeyX","KeyC","KeyV","KeyB","KeyN","KeyM","Comma","Period","Slash","ArrowUp","ShiftRight","ControlLeft","MetaLeft","AltLeft","Space","AltRight","ArrowLeft","ArrowDown","ArrowRight","ControlRight"],this.specialLetters=["Backspace","Tab","Del","Caps Lock","Enter","Shift","Ctrl","Win","Alt","Space","◄","▼","►","▲"],this.specialCodes=["Backspace","Tab","Delete","CapsLock","Enter","ShiftLeft","ShiftRight","ControlLeft","ControlRight","MetaLeft","AltLeft","AltRight","Space","ArrowLeft","ArrowDown","ArrowRight","ArrowUp"],this.rowLength=[14,15,13,13,9],this.keyNumberStartRow=[0,14,29,42,55],this.userLanguage={en:{classic:["`","1","2","3","4","5","6","7","8","9","0","-","=","Backspace","Tab","q","w","e","r","t","y","u","i","o","p","[","]","\\","Del","Caps Lock","a","s","d","f","g","h","j","k","l",";","'","Enter","Shift","z","x","c","v","b","n","m",",",".","/","▲","Shift","Ctrl","Win","Alt","Space","Alt","◄","▼","►","Ctrl"],shift:["~","!","@","#","$","%","^","&","*","(",")","_","+","Backspace","Tab","Q","W","E","R","T","Y","U","I","O","P","{","}","|","Del","Caps Lock","A","S","D","F","G","H","J","K","L",":",'"',"Enter","Shift","Z","X","C","V","B","N","M","<",">","?","▲","Shift","Ctrl","Win","Alt","Space","Alt","◄","▼","►","Ctrl"]},ru:{classic:["ё","1","2","3","4","5","6","7","8","9","0","-","=","Backspace","Tab","й","ц","у","к","е","н","г","ш","щ","з","х","ъ","\\","Del","Caps Lock","ф","ы","в","а","п","р","о","л","д","ж","э","Enter","Shift","я","ч","с","м","и","т","ь","б","ю",".","▲","Shift","Ctrl","Win","Alt","Space","Alt","◄","▼","►","Ctrl"],shift:["Ё","!",'"',"№",";","%",":","?","*","(",")","-","=","Backspace","Tab","Й","Ц","У","К","Е","Н","Г","Ш","Щ","З","Х","Ъ","\\","Del","Caps Lock","Ф","Ы","В","А","П","Р","О","Л","Д","Ж","Э","Enter","Shift","Я","Ч","С","М","И","Т","Ь","Б","Ю",",","▲","Shift","Ctrl","Win","Alt","Space","Alt","◄","▼","►","Ctrl"]}}}var a,s;return a=e,(s=[{key:"initLanguage",value:function(){localStorage.getItem("currentLanguage")?this.currentLanguage=JSON.parse(localStorage.getItem("currentLanguage")):(this.currentLanguage="en",localStorage.setItem("currentLanguage",JSON.stringify(this.currentLanguage)))}},{key:"changeLanguage",value:function(){"ru"===this.currentLanguage?(this.currentLanguage="en",localStorage.setItem("currentLanguage",JSON.stringify(this.currentLanguage))):(this.currentLanguage="ru",localStorage.setItem("currentLanguage",JSON.stringify(this.currentLanguage))),this.updateKeyboard()}},{key:"createKeys",value:function(e){var t=this,a=this.userLanguage[this.currentLanguage].classic.slice(this.keyNumberStartRow[e],this.keyNumberStartRow[e]+this.rowLength[e]),r=[];return a.forEach((function(a,s){var i=document.createElement("div");if(i.classList.add("keyboard__key"),t.specialLetters.includes(a))i.textContent=a,i.classList.add("keyboard__key_special");else{var n=a.toLowerCase();t.shiftFlag&&!t.capsFlag&&(n=t.userLanguage[t.currentLanguage].shift[t.keyNumberStartRow[e]+s]),t.shiftFlag&&t.capsFlag?n=t.userLanguage[t.currentLanguage].shift[t.keyNumberStartRow[e]+s].toLowerCase():t.capsFlag&&(n=a.toUpperCase()),i.textContent=n,i.classList.add("keyboard__key_classic")}i.classList.add(t.keyboardCodes[t.keyNumberStartRow[e]+s]),"Caps Lock"===a&&t.capsFlag&&i.classList.add("active"),"Shift"===a&&t.shiftFlag&&t.keyboardCodes[t.keyNumberStartRow[e]+s]===t.shiftType&&i.classList.add("active"),r.push(i)})),r}},{key:"initKeyboardLayout",value:function(){for(var e=[],a=0;a<5;a+=1){var r=document.createElement("div");r.classList.add("keyboard__row");var s=this.createKeys(a);r.append.apply(r,t(s)),e.push(r)}return e}},{key:"addText",value:function(e){var t=document.querySelector(".text-area");document.activeElement===t&&(this.positionCursor=t.selectionEnd);var a=t.textContent.split(""),r=a[this.positionCursor];a.splice(this.positionCursor,1,e,r),t.textContent=a.join(""),this.positionCursor+=1}},{key:"initPage",value:function(){var e=document.querySelector("body");e.classList.add("page");var a=document.createElement("div");a.classList.add("wrapper");var r=document.createElement("h1");r.classList.add("title"),r.textContent="Virtual Keyboard";var s=document.createElement("textarea");s.classList.add("text-area");var i=document.createElement("div");i.classList.add("keyboard");var n=document.createElement("p");n.classList.add("additional-text"),n.textContent="Клавиатура создана в операционной системе Windows. Для переключения языка комбинация: левый ctrl + alt",e.append(a),a.append(r),a.append(s),a.append(i),a.append(n),i.append.apply(i,t(this.initKeyboardLayout()))}},{key:"updateKeyboard",value:function(){var e=document.getElementsByClassName("keyboard")[0];e.innerHTML="",e.append.apply(e,t(this.initKeyboardLayout())),this.listenVirtualKeyboard()}},{key:"InputSpecialKeys",value:function(e){var t=document.querySelector(".text-area");if("ArrowLeft"===e)this.addText("◄");else if("ArrowRight"===e)this.addText("►");else if("ArrowDown"===e)this.addText("▼");else if("ArrowUp"===e)this.addText("▲");else if("Enter"===e)this.addText("\n");else if("Space"===e)this.addText(" ");else if("Tab"===e)this.addText("    "),this.positionCursor+=3;else if("CapsLock"===e)this.capsFlag=!this.capsFlag,this.updateKeyboard();else if("Backspace"===e)if(t.focus(),this.positionCursor>=0&&t.selectionEnd>0){this.positionCursor=t.selectionEnd-1;var a=t.textContent.split("");a.splice(this.positionCursor,1),t.textContent=a.join("")}else this.positionCursor=t.selectionEnd;else if("Delete"===e){if(t.focus(),this.positionCursor<t.textContent.length||t.selectionEnd<t.textContent.length){this.positionCursor=t.selectionEnd;var r=t.textContent.split("");r.splice(this.positionCursor,1),t.textContent=r.join("")}}else"ShiftRight"!==e&&"ShiftLeft"!==e||(this.shiftFlag=!0,this.shiftType=e,this.updateKeyboard())}},{key:"listenVirtualKeyboard",value:function(){var e=this,t=document.getElementsByClassName("keyboard__key_classic"),a=document.getElementsByClassName("keyboard__key_special");Array.from(t).forEach((function(t){t.addEventListener("mousedown",(function(t){var a=e.keyboardCodes.indexOf(t.target.classList[t.target.classList.length-1]);t.target.classList.add("active");var r=document.getElementsByClassName("text-area")[0],s=e.userLanguage[e.currentLanguage].classic[a];e.shiftFlag&&!e.capsFlag?s=e.userLanguage[e.currentLanguage].shift[a]:e.shiftFlag&&e.capsFlag?s=e.userLanguage[e.currentLanguage].shift[a].toLowerCase():e.capsFlag&&(s=e.userLanguage[e.currentLanguage].classic[a].toUpperCase()),e.addText(s),r.setSelectionRange(e.positionCursor,e.positionCursor),r.focus()})),t.addEventListener("mouseup",(function(e){e.target.classList.remove("active")}))})),Array.from(a).forEach((function(t){t.addEventListener("mousedown",(function(a){var r=a.target.classList[a.target.classList.length-1];"active"===r&&(r=a.target.classList[a.target.classList.length-2]);var s=document.getElementsByClassName("text-area")[0];e.InputSpecialKeys(r,s),"CapsLock"!==r&&a.target.classList.add("active"),Array.from(t.classList).includes("ControlLeft")&&(e.languageFlag=!0),s.setSelectionRange(e.positionCursor,e.positionCursor)})),t.addEventListener("mouseup",(function(t){"ShiftRight"!==t.target.classList[t.target.classList.length-2]&&"ShiftLeft"!==t.target.classList[t.target.classList.length-2]||(e.shiftFlag=!1,e.updateKeyboard()),(Array.from(t.target.classList).includes("AltLeft")||Array.from(t.target.classList).includes("AltRight"))&&!0===e.languageFlag&&(e.languageFlag=!1,e.changeLanguage()),"CapsLock"!==t.target.classList[t.target.classList.length-2]&&t.target.classList.remove("active")}))}))}},{key:"listenPhysicalKeyboard",value:function(){var e=this;window.addEventListener("keydown",(function(t){t.preventDefault();var a=t.code,r=document.querySelector(".".concat(a)),s=document.querySelector(".text-area");if(!e.specialCodes.includes(a)){r.classList.add("active");var i=e.userLanguage[e.currentLanguage].classic[[e.keyboardCodes.indexOf(t.code)]].toLowerCase();e.shiftFlag&&!e.capsFlag?i=e.userLanguage[e.currentLanguage].shift[e.keyboardCodes.indexOf(t.code)]:e.shiftFlag&&e.capsFlag?i=e.userLanguage[e.currentLanguage].shift[e.keyboardCodes.indexOf(t.code)].toLowerCase():e.capsFlag&&(i=t.key.toUpperCase()),e.addText(i)}e.InputSpecialKeys(a,s),e.specialCodes.includes(a)&&("CapsLock"!==a&&r.classList.add("active"),"ControlLeft"===a&&(e.languageFlag=!0)),s.setSelectionRange(e.positionCursor,e.positionCursor)}),!1),window.addEventListener("keyup",(function(t){var a=t.code;"ShiftRight"!==t.code&&"ShiftLeft"!==t.code||(e.shiftFlag=!1,e.updateKeyboard()),"AltLeft"!==a&&"AltRight"!==a||!0!==e.languageFlag||(e.languageFlag=!1,e.changeLanguage()),"CapsLock"!==a&&document.querySelector(".".concat(a)).classList.remove("active")}))}}])&&r(a.prototype,s),Object.defineProperty(a,"prototype",{writable:!1}),e}();window.addEventListener("DOMContentLoaded",(function(){var e=new s;e.initLanguage(),e.initPage(),e.listenVirtualKeyboard(),e.listenPhysicalKeyboard()}))})();